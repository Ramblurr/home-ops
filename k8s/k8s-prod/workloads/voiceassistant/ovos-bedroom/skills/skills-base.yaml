---
# yaml-language-server: $schema=https://github.com/yannh/kubernetes-json-schema/raw/master/v1.27.4-standalone-strict/statefulset-apps-v1.json
apiVersion: apps/v1
kind: StatefulSet
metadata:
  name: &name bedroom-base-skills
  namespace: voiceassistant
spec:
  serviceName: *name
  replicas: 1
  selector:
    matchLabels:
      app: *name
  template:
    metadata:
      labels:
        app: *name
    spec:
      containers:
        - name: skill-wikipedia
          image: docker.io/smartgic/ovos-skill-wikipedia:0.0.8aa
          env: &base-env
            - name: TZ
              value: Europe/Berlin
            - name: HOME
              value: /home/ovos
          volumeMounts: &skill-mnt
            - name: ovos-mycroft-config
              mountPath: /home/ovos/.config
              subPath: bedroom-skills/config
            - name: ovos-mycroft-config
              mountPath: /home/ovos/.local/share
              subPath: bedroom-skills/share
            - name: ovos-tmp
              mountPath: /tmp/mycroft
        - name: skill-weather
          image: docker.io/smartgic/ovos-skill-weather:0.0.8a
          volumeMounts: *skill-mnt
          env: *base-env
        - name: skill-volume
          image: docker.io/smartgic/ovos-skill-volume:0.0.8aa
          volumeMounts: *skill-mnt
          env: *base-env
        - name: skill-date-time
          image: docker.io/smartgic/ovos-skill-date-time:0.0.8aa
          volumeMounts: *skill-mnt
          env: *base-env
        - name: skill-stop
          image: docker.io/smartgic/ovos-skill-stop:0.0.8aa
          volumeMounts: *skill-mnt
          env: *base-env
        - name: skill-personal
          image: docker.io/smartgic/ovos-skill-personal:0.0.8aa
          volumeMounts: *skill-mnt
          env: *base-env
        - name: skill-fallback-unknown
          image: docker.io/smartgic/ovos-skill-fallback-unknown:0.0.8aa
          volumeMounts: *skill-mnt
          env: *base-env
        - name: skill-hello-world
          image: docker.io/smartgic/ovos-skill-hello-world:0.0.8aa
          volumeMounts: *skill-mnt
          env: *base-env
        - name: skill-alerts
          image: docker.io/smartgic/ovos-skill-alerts:0.0.8aa
          volumeMounts: *skill-mnt
          env: *base-env
        #- name: skill-wolfie
        #  image: docker.io/smartgic/ovos-skill-wolfie:alpha@sha256:0e9efed88854bddda70dc1d89a662eeae03a993b5b34f3f8c96cb532f6926cbc
        #  volumeMounts: *skill-mnt
        #  env: *base-env
        - name: skill-jokes
          image: docker.io/smartgic/ovos-skill-jokes:alpha@sha256:b8d2c3a0ecc8fcfa306ec01398cbb7a4c723c13efb5a48acccfc21eccd9d8f08
          volumeMounts: *skill-mnt
          env: *base-env
        - name: skill-homeassistant
          image: ghcr.io/ramblurr/neon-homeassistant-skill-dev:rolling@sha256:47706ae14db176fe8df999f338af4440b6180ddf0a69b6d876c104b4dbcafafa
          volumeMounts: *skill-mnt
          env: *base-env
        - name: skill-chatgpt
          image: ghcr.io/ramblurr/skill-ovos-fallback-chatgpt-dev:rolling@sha256:c6a9dbbcb72c5dc7efafbf0e5ff917dd5abae5333e6b3777b499238c3509acc3
          volumeMounts: *skill-mnt
          env: *base-env

      volumes:
        - name: ovos-mycroft-config
          persistentVolumeClaim:
            claimName: ovos-data-nfs
        - name: ovos-tmp
          emptyDir: {}
      securityContext:
        fsGroup: 2000
        runAsGroup: 2000
        runAsUser: 1000
